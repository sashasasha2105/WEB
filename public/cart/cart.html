<!-- === File: public/cart/cart.html === -->

<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>clip & go ‚Ä¢ –ö–æ—Ä–∑–∏–Ω–∞</title>

  <!-- Montserrat -->
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet"/>

  <!-- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ -->
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="/css/responsive.css" media="(max-width:768px)" />
  <link rel="stylesheet" href="/css/header.css" />

  <!-- –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –∫–æ—Ä–∑–∏–Ω—ã -->
  <link rel="stylesheet" href="/cart/cart.css" />

  <!-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç -->
  <script src="/config.js"></script>
  <script>
    (function () {
      if (window.__ENV && window.__ENV.YANDEX_JSAPI_KEY) {
        const s = document.createElement('script');
        s.src = `https://api-maps.yandex.ru/2.1/?apikey=${window.__ENV.YANDEX_JSAPI_KEY}&lang=ru_RU`;
        s.onload = () => console.log('[Maps] –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
        s.onerror = () => console.error('[Maps] –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç');
        document.head.appendChild(s);
      } else {
        console.warn('[Maps] –ö–ª—é—á API –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
      }
    })();
  </script>
</head>

<body>
<!-- –û–±—â–∏–π header -->
<div id="header-container"></div>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    fetch('/header.html')
            .then(r => r.text())
            .then(html => {
              document.getElementById('header-container').innerHTML = html;

              const hdr = document.getElementById('site-header');
              if (hdr) {
                hdr.classList.remove('scrolled');
                const TH = 50;
                const onScroll = () =>
                        window.scrollY > TH ? hdr.classList.add('scrolled') : hdr.classList.remove('scrolled');
                onScroll();
                window.addEventListener('scroll', onScroll);
              }

              // –í–ê–ñ–ù–û: –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ CartManager –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
              const waitForCartManager = () => {
                if (window.CartManager) {
                  console.log('[Header] CartManager –Ω–∞–π–¥–µ–Ω, –æ–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–æ—Ä–∑–∏–Ω—ã');
                  window.CartManager.updateCartCounter();
                } else {
                  console.log('[Header] –û–∂–∏–¥–∞–Ω–∏–µ CartManager...');
                  setTimeout(waitForCartManager, 50);
                }
              };

              // –ù–∞—á–∏–Ω–∞–µ–º –æ–∂–∏–¥–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É
              setTimeout(waitForCartManager, 100);
            })
            .catch(console.error);
  });
</script>

<main>
  <h1>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h1>

  <!-- === –ë–ª–æ–∫ —Å —Ç–æ–≤–∞—Ä–∞–º–∏ === -->
  <div id="cartItemsContainer">
    <div class="cart-item" data-id="camera">
      <img src="/assets/images/cam3.jpg" alt="clip & go" />
      <div class="item-info">
        <h2>clip & go</h2>
        <p>–¶–≤–µ—Ç: <span id="cameraColor">‚Äî</span></p>
        <p>–¶–µ–Ω–∞ –∑–∞ —à—Ç.: <span id="cameraUnitPrice">8 900</span> ‚ÇΩ</p>
      </div>
      <div class="quantity-selector">
        <button class="minus-btn" data-id="camera">‚Äì</button>
        <span class="quantity-value" data-id="camera">0</span>
        <button class="plus-btn" data-id="camera">+</button>
      </div>
      <button class="remove-item-btn" data-id="camera">–£–¥–∞–ª–∏—Ç—å</button>
    </div>

    <div class="cart-item" data-id="memory">
      <img src="/assets/images/CardPhoto.png" alt="–ö–∞—Ä—Ç–∞ –ø–∞–º—è—Ç–∏ 8 –ì–ë" />
      <div class="item-info">
        <h2>–ö–∞—Ä—Ç–∞ –ø–∞–º—è—Ç–∏ 8 –ì–ë</h2>
        <p>–¶–µ–Ω–∞ –∑–∞ —à—Ç.: <span id="memoryUnitPrice">500</span> ‚ÇΩ</p>
      </div>
      <div class="quantity-selector">
        <button class="minus-btn" data-id="memory">‚Äì</button>
        <span class="quantity-value" data-id="memory">0</span>
        <button class="plus-btn" data-id="memory">+</button>
      </div>
      <button class="remove-item-btn" data-id="memory">–£–¥–∞–ª–∏—Ç—å</button>
    </div>
  </div>
  <!-- === /–ë–ª–æ–∫ —Å —Ç–æ–≤–∞—Ä–∞–º–∏ === -->

  <!-- === –ë–ª–æ–∫ —Å –ø—Ä–æ–º–æ–∫–æ–¥–æ–º === -->
  <div class="promo-section">
    <label for="promoInput">–ü—Ä–æ–º–æ–∫–æ–¥:</label>
    <input type="text" id="promoInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥‚Ä¶" />
    <button id="applyPromoBtn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
    <button id="removePromoBtn" style="display:none; background:#dc3545; margin-left:8px;">–£–±—Ä–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</button>
  </div>
  <!-- === /–ë–ª–æ–∫ —Å –ø—Ä–æ–º–æ–∫–æ–¥–æ–º === -->

  <!-- === –ê–¥—Ä–µ—Å –∏ —Å–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏ === -->
  <section class="delivery-section">
    <h2>–ê–¥—Ä–µ—Å –∏ —Å–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏</h2>

    <!-- –≤–≤–æ–¥ –≥–æ—Ä–æ–¥–∞ -->
    <label for="addressInput">–ì–æ—Ä–æ–¥:</label>
    <div class="address-wrapper" style="position:relative;">
      <input
              type="text"
              id="addressInput"
              autocomplete="off"
              placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥‚Ä¶"
      />
      <ul id="citySuggestions" class="suggestions"></ul>
    </div>

    <!-- –≤—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ -->
    <div id="deliveryMethodSection" class="section-block">
      <label>–°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
      <div class="delivery-options-container">
        <div class="delivery-option">
          <input
                  type="radio"
                  id="deliveryCourier"
                  name="deliveryMethod"
                  value="courier"
          />
          <label for="deliveryCourier">
            <img
                    src="/assets/icons/cdek-truck.png"
                    class="delivery-icon"
                    alt="–ö—É—Ä—å–µ—Ä –°–î–≠–ö"
            />
            –ö—É—Ä—å–µ—Ä –°–î–≠–ö
          </label>
        </div>
        <div class="delivery-option">
          <input
                  type="radio"
                  id="deliveryPvz"
                  name="deliveryMethod"
                  value="pvz"
          />
          <label for="deliveryPvz">
            <img
                    src="/assets/icons/cdek-pvz.png"
                    class="delivery-icon"
                    alt="–ü–í–ó –°–î–≠–ö"
            />
            –ü–í–ó –°–î–≠–ö
          </label>
        </div>
      </div>
    </div>

    <!-- –≤–≤–æ–¥ —É–ª–∏—Ü—ã -->
    <div id="streetWrapper" class="section-block" style="margin-top:15px;">
      <label for="streetInput">–£–ª–∏—Ü–∞ –∏ –¥–æ–º:</label>
      <input
              type="text"
              id="streetInput"
              placeholder="–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –≤ –≥–æ—Ä–æ–¥–µ‚Ä¶"
      />
    </div>

    <!-- –∫–∞—Ä—Ç–∞ –∏ –∏–Ω—Ñ–æ-–ø–∞–Ω–µ–ª—å -->
    <div class="map-wrapper">
      <div id="map"></div>
      <div id="pvz-info-panel"></div>
    </div>

    <!-- –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–∞—Ä–∏—Ñ–æ–≤ -->
    <div id="tariffOptions"></div>
  </section>
  <!-- === /–ê–¥—Ä–µ—Å –∏ —Å–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏ === -->

  <!-- === –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è === -->
  <section class="delivery-section" id="recipientSection">
    <h2>–î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</h2>

    <div class="recipient-form">
      <div class="form-field full">
        <label for="recipientName">–§–ò–û –ø–æ–ª—É—á–∞—Ç–µ–ª—è *</label>
        <input
                type="text"
                id="recipientName"
                placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"
                required
        />
      </div>

      <div class="form-field">
        <label for="recipientPhone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
        <input
                type="tel"
                id="recipientPhone"
                placeholder="+7 999 000 11 22"
                required
        />
      </div>

      <div class="form-field">
        <label for="recipientEmail">Email (–ø–æ –∂–µ–ª–∞–Ω–∏—é)</label>
        <input
                type="email"
                id="recipientEmail"
                placeholder="user@example.com"
        />
      </div>
    </div>

    <div style="margin-top: 20px; padding: 15px; background: #e6f7ff; border-radius: 8px; font-size: 0.9em; color: #005bb5;">
      <strong>üí° –í–∞–∂–Ω–æ:</strong> –£–∫–∞–∂–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–≤—è–∑–∏. –ö—É—Ä—å–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º –ø–µ—Ä–µ–¥ –¥–æ—Å—Ç–∞–≤–∫–æ–π.
    </div>
  </section>
  <!-- === /–î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è === -->

  <!-- === –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ –∏ –∫–Ω–æ–ø–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è === -->
  <div class="cart-summary">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
      <span>–¢–æ–≤–∞—Ä—ã:</span>
      <span><strong><span id="itemsSubtotal">0</span> ‚ÇΩ</strong></span>
    </div>
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
      <span>–î–æ—Å—Ç–∞–≤–∫–∞:</span>
      <span><strong><span id="shippingCostValue">0</span> ‚ÇΩ</strong></span>
    </div>
    <div id="discountRow" style="display: none; justify-content: space-between; align-items: center; margin-bottom: 15px; color: #28a745;">
      <span>–°–∫–∏–¥–∫–∞:</span>
      <span><strong>-<span id="discountAmount">0</span> ‚ÇΩ</strong></span>
    </div>
    <hr style="margin: 15px 0; border: none; border-top: 1px solid #e0e0e0;">
    <h2 style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <span>–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:</span>
      <span><span id="cartTotalValue">0</span> ‚ÇΩ</span>
    </h2>
    <div id="deliveryInfo" style="margin-bottom:16px;font-size:1em;color:#005bb5;text-align:center;"></div>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–ø–æ—Å–æ–±–∞—Ö –æ–ø–ª–∞—Ç—ã -->
    <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; text-align: center;">
      <div style="margin-bottom: 10px; font-size: 0.9em; color: #666;">–ü—Ä–∏–Ω–∏–º–∞–µ–º –∫ –æ–ø–ª–∞—Ç–µ:</div>
      <div style="display: flex; justify-content: center; align-items: center; gap: 15px; flex-wrap: wrap;">
        <img src="/assets/icons/payments/visa.png" alt="Visa" style="height: 20px;">
        <img src="/assets/icons/payments/mastercard.png" alt="Mastercard" style="height: 20px;">
        <img src="/assets/icons/payments/mir.png" alt="–ú–ò–†" style="height: 20px;">
        <img src="/assets/icons/payments/sbp.png" alt="–°–ë–ü" style="height: 20px;">
      </div>
    </div>

    <button id="checkoutBtn">
      <span style="margin-right: 8px;">üîí</span>
      –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ –∏ –æ–ø–ª–∞—Ç–∏—Ç—å
    </button>

    <div style="margin-top: 15px; font-size: 0.85em; color: #666; text-align: center; line-height: 1.4;">
      –ù–∞–∂–∏–º–∞—è –∫–Ω–æ–ø–∫—É, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å
      <a href="/Policy/privacy-cookie-policy.html" style="color: #007BFF;">–ø–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
      –∏ —É—Å–ª–æ–≤–∏—è–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    </div>
  </div>
  <!-- === /–ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ === -->
</main>

<footer>
  <p>¬© 2025 clip & go. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
  <p>
    <a href="/Policy/privacy-cookie-policy.html">–ü–æ–ª–∏—Ç–∏–∫–∞ cookies –∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
  </p>
</footer>

<!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
<div id="notificationContainer"></div>

<!-- –°–∫—Ä–∏–ø—Ç—ã -->
<script src="/js/cart-manager.js"></script>
<script src="/js/script.js"></script>
<script src="/js/mobile-header.js"></script>
<script src="/cart/cart.js"></script>

<!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
<style>
  #notificationContainer {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 9999;
    pointer-events: none;
  }

  #notificationContainer > * {
    pointer-events: auto;
  }

  /* –£–ª—É—á—à–µ–Ω–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–º–æ–∫–æ–¥–∞ */
  #removePromoBtn:hover {
    background: #c82333 !important;
    transform: scale(1.02);
  }

  /* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è —Ñ–æ—Ä–º—ã –ø–æ–ª—É—á–∞—Ç–µ–ª—è */
  .recipient-form {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 20px;
    margin-bottom: 20px;
  }

  .form-field.full {
    grid-column: 1 / -1;
  }

  .form-field label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
    color: #333;
  }

  .form-field input {
    width: 100%;
    height: 48px;
    padding: 12px 16px;
    border: 1px solid #ccc;
    border-radius: 8px;
    font-size: 1em;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
  }

  .form-field input:focus {
    outline: none;
    border-color: #007BFF;
    box-shadow: 0 0 8px rgba(0,123,255,0.2);
  }

  .form-field input:invalid {
    border-color: #dc3545;
  }

  .form-field input:valid {
    border-color: #28a745;
  }

  /* –£–ª—É—á—à–µ–Ω–∏—è –∏—Ç–æ–≥–æ–≤–æ–π —Å—É–º–º—ã */
  .cart-summary {
    background: #fff;
    border-radius: 12px;
    padding: 30px;
    margin-bottom: 40px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    border: 1px solid #e0e0e0;
  }

  /* –ê–¥–∞–ø—Ç–∏–≤ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
  @media (max-width: 768px) {
    .recipient-form {
      grid-template-columns: 1fr;
      gap: 15px;
    }

    .cart-summary {
      padding: 20px;
      margin-bottom: 30px;
    }

    #checkoutBtn {
      font-size: 1em;
      padding: 16px 40px;
    }
  }
</style>

</body>
</html>