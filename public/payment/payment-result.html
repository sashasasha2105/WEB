<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>–†–µ–∑—É–ª—å—Ç–∞—Ç –æ–ø–ª–∞—Ç—ã ‚Äî clip & go</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Montserrat -->
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
            href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap"
            rel="stylesheet"
    />

    <!-- –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="payment-result.css" />
</head>
<body>
<!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω -->
<div class="animated-bg">
    <div class="floating-element" style="top: 10%; left: 10%; animation-delay: 0s;"></div>
    <div class="floating-element" style="top: 20%; right: 15%; animation-delay: 1s;"></div>
    <div class="floating-element" style="bottom: 30%; left: 20%; animation-delay: 2s;"></div>
    <div class="floating-element" style="bottom: 15%; right: 25%; animation-delay: 0.5s;"></div>
</div>

<div class="container">
    <!-- –ì–ª–∞–≤–Ω—ã–π –±–ª–æ–∫ —É—Å–ø–µ—Ö–∞ -->
    <div class="success-hero">
        <div class="success-icon-wrapper">
            <div class="success-icon">
                <div class="simple-checkmark">
                    <div class="checkmark-circle-bg"></div>
                    <svg class="checkmark-svg" viewBox="0 0 52 52">
                        <circle class="checkmark-circle" cx="26" cy="26" r="22" fill="none"/>
                        <path class="checkmark-check" fill="none" d="m16 26 6 6 12-12"/>
                    </svg>
                </div>
            </div>
        </div>
        <h1 class="success-title">–û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!</h1>
        <p class="success-subtitle">–í–∞—à –∑–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω –∏ —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω –≤ –¥–æ—Å—Ç–∞–≤–∫—É</p>

        <!-- –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ -->
        <div class="order-status-timeline">
            <div class="status-step completed">
                <div class="status-icon">üí≥</div>
                <span>–û–ø–ª–∞—á–µ–Ω–æ</span>
            </div>
            <div class="status-step active" id="currentStatusStep">
                <div class="status-icon">üì¶</div>
                <span>–°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–∫–∞–∑</span>
            </div>
            <div class="status-step" id="shippingStep">
                <div class="status-icon">üöö</div>
                <span>–í –ø—É—Ç–∏</span>
            </div>
            <div class="status-step" id="deliveredStep">
                <div class="status-icon">‚úÖ</div>
                <span>–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ</span>
            </div>
        </div>

        <!-- –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ -->
        <div class="status-progress" id="statusProgress">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="status-text" id="statusText">–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–∞—à –∑–∞–∫–∞–∑...</div>
        </div>
    </div>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑–µ -->
    <div class="order-info-card">
        <div class="card-header">
            <h2>–î–µ—Ç–∞–ª–∏ –≤–∞—à–µ–≥–æ –∑–∞–∫–∞–∑–∞</h2>
            <div class="order-id" id="orderId">–ó–∞–∫–∞–∑ #<span id="orderNumber">-</span></div>
        </div>

        <!-- –¢–æ–≤–∞—Ä—ã -->
        <div class="order-items-section">
            <h3>üì¶ –í–∞—à–∏ —Ç–æ–≤–∞—Ä—ã</h3>
            <div class="items-grid" id="itemsList">
                <!-- JS –∑–∞–ø–æ–ª–Ω–∏—Ç —Ç–æ–≤–∞—Ä—ã -->
            </div>
        </div>

        <!-- –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div class="financial-summary">
            <div class="summary-row">
                <span>–¢–æ–≤–∞—Ä—ã:</span>
                <span id="itemsTotal">0 ‚ÇΩ</span>
            </div>
            <div class="summary-row">
                <span>–î–æ—Å—Ç–∞–≤–∫–∞:</span>
                <span id="deliveryTotal">0 ‚ÇΩ</span>
            </div>
            <div class="summary-row discount-row" id="discountRow" style="display: none;">
                <span>–°–∫–∏–¥–∫–∞:</span>
                <span id="discountAmount">-0 ‚ÇΩ</span>
            </div>
            <div class="summary-row total-row">
                <span>–ö –æ–ø–ª–∞—Ç–µ:</span>
                <span id="finalTotal">0 ‚ÇΩ</span>
            </div>
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ -->
        <div class="delivery-info" id="deliveryInfo">
            <h3>üöö –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ</h3>
            <div class="delivery-details">
                <div class="delivery-icon">üöö</div>
                <div class="delivery-text">
                    <p id="deliveryMethod">–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è...</p>
                    <p id="deliveryAddress">–ê–¥—Ä–µ—Å –±—É–¥–µ—Ç —É–∫–∞–∑–∞–Ω –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–∞</p>
                    <p class="delivery-time" id="deliveryTime">–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏: 2-5 –¥–Ω–µ–π</p>
                </div>
            </div>
        </div>

        <!-- –ü–æ–ª—É—á–∞—Ç–µ–ª—å -->
        <div class="recipient-info" id="recipientInfo">
            <h3>üë§ –ü–æ–ª—É—á–∞—Ç–µ–ª—å</h3>
            <div class="recipient-details">
                <div class="recipient-name" id="recipientName">‚Äî</div>
                <div class="recipient-contacts">
                    <span id="recipientPhone">‚Äî</span>
                    <span id="recipientEmail" style="display: none;">‚Äî</span>
                </div>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç—É—Å —Ç—Ä–µ–∫–∏–Ω–≥–∞ -->
        <div class="tracking-info" id="trackingInfo" style="display: none;">
            <h3>üìç –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ</h3>
            <div class="tracking-details">
                <div class="tracking-number">
                    <strong>–ù–æ–º–µ—Ä –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –°–î–≠–ö:</strong>
                    <span id="cdekTrackingNumber">‚Äî</span>
                    <button id="copyTrackingBtn" class="copy-btn" style="display: none;">üìã</button>
                </div>
                <a href="#" id="cdekTrackingLink" target="_blank" class="tracking-link" style="display: none;">
                    –û—Ç—Å–ª–µ–¥–∏—Ç—å –Ω–∞ —Å–∞–π—Ç–µ –°–î–≠–ö ‚Üí
                </a>
            </div>
        </div>
    </div>

    <!-- –ü–æ–ª–µ–∑–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
    <div class="action-cards">
        <div class="action-card primary-action">
            <div class="action-icon">üë§</div>
            <h3>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h3>
            <p>–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å—Ç–∞—Ç—É—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ –≤—Å–µ –≤–∞—à–∏ –∑–∞–∫–∞–∑—ã</p>
            <a href="/profile/profile.html" class="action-btn primary">–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
        </div>

        <div class="action-card">
            <div class="action-icon">üõí</div>
            <h3>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</h3>
            <p>–û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –¥—Ä—É–≥–∏–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏ –≤ –Ω–∞—à–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ</p>
            <a href="/index.html" class="action-btn">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
        </div>

        <div class="action-card">
            <div class="action-icon">üìû</div>
            <h3>–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?</h3>
            <p>–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞—à–µ–π —Å–ª—É–∂–±–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏</p>
            <a href="https://t.me/clipandgomanager" class="action-btn" target="_blank">Telegram</a>
        </div>
    </div>

    <!-- –ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="info-section">
        <div class="info-cards">
            <div class="info-card">
                <div class="info-icon">üìß</div>
                <h4>Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h4>
                <p>–ú—ã –æ—Ç–ø—Ä–∞–≤–∏–º –≤–∞–º –ø–∏—Å—å–º–æ —Å –¥–µ—Ç–∞–ª—è–º–∏ –∑–∞–∫–∞–∑–∞ –∏ –Ω–æ–º–µ—Ä–æ–º –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è</p>
            </div>
            <div class="info-card">
                <div class="info-icon">üîí</div>
                <h4>–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–ª–∞—Ç–∞</h4>
                <p>–í–∞—à –ø–ª–∞—Ç–µ–∂ –∑–∞—â–∏—â–µ–Ω –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º SSL –∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω —á–µ—Ä–µ–∑ YooKassa</p>
            </div>
            <div class="info-card">
                <div class="info-icon">üéÅ</div>
                <h4>–ì–∞—Ä–∞–Ω—Ç–∏—è –∫–∞—á–µ—Å—Ç–≤–∞</h4>
                <p>–ù–∞ –≤—Å–µ —Ç–æ–≤–∞—Ä—ã clip & go –¥–µ–π—Å—Ç–≤—É–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è</p>
            </div>
        </div>
    </div>
</div>

<!-- –í—Å–ø–ª—ã–≤–∞—é—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
<div id="notificationContainer" class="notification-container"></div>

<!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
<div id="orderStatusModal" class="modal">
    <div class="modal-content">
        <span class="modal-close">&times;</span>
        <h3>üì¶ –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞</h3>
        <div id="orderStatusDetails"></div>
    </div>
</div>

<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä—ã -->
<script src="/js/cart-manager.js"></script>
<script src="/js/order-manager.js"></script>

<script>
    // ===== –£–õ–£–ß–®–ï–ù–ù–ê–Ø –°–¢–†–ê–ù–ò–¶–ê –†–ï–ó–£–õ–¨–¢–ê–¢–ê –û–ü–õ–ê–¢–´ –° –ò–ù–¢–ï–ì–†–ê–¶–ò–ï–ô –ó–ê–ö–ê–ó–û–í =====

    // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    const CONFIG = {
        CAMERA_PRICE: 8900,
        MEMORY_PRICE: 500,
        STATUS_UPDATE_INTERVAL: 3000, // 3 —Å–µ–∫—É–Ω–¥—ã
        PROGRESS_ANIMATION_DURATION: 2000
    };

    // –°–æ—Å—Ç–æ—è–Ω–∏–µ
    let currentOrder = null;
    let statusCheckInterval = null;
    let progressAnimation = null;

    // –ö–µ—à DOM —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    const DOM = {
        orderNumber: null,
        itemsList: null,
        itemsTotal: null,
        deliveryTotal: null,
        finalTotal: null,
        deliveryMethod: null,
        deliveryAddress: null,
        deliveryTime: null,
        recipientName: null,
        recipientPhone: null,
        recipientEmail: null,
        statusText: null,
        progressFill: null,
        currentStatusStep: null,
        trackingInfo: null,
        cdekTrackingNumber: null,
        discountRow: null,
        discountAmount: null
    };

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
    document.addEventListener('DOMContentLoaded', () => {
        console.log('üéâ –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω–∞');

        initializePage();
    });

    // –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    async function initializePage() {
        try {
            cacheDOMElements();

            // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ OrderManager
            await waitForOrderManager();

            await loadOrderData();

            setupEventListeners();

            startStatusMonitoring();

            scheduleAnimationsAndNotifications();

            console.log('‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');

        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
            showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞');
        }
    }

    // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ OrderManager
    function waitForOrderManager() {
        return new Promise((resolve) => {
            if (window.OrderManager) {
                resolve();
                return;
            }

            const checkInterval = setInterval(() => {
                if (window.OrderManager) {
                    clearInterval(checkInterval);
                    resolve();
                }
            }, 100);

            // –¢–∞–π–º–∞—É—Ç —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                clearInterval(checkInterval);
                console.warn('‚ö†Ô∏è OrderManager –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è –∑–∞ 5 —Å–µ–∫—É–Ω–¥');
                resolve();
            }, 5000);
        });
    }

    // –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ DOM —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    function cacheDOMElements() {
        DOM.orderNumber = document.getElementById('orderNumber');
        DOM.itemsList = document.getElementById('itemsList');
        DOM.itemsTotal = document.getElementById('itemsTotal');
        DOM.deliveryTotal = document.getElementById('deliveryTotal');
        DOM.finalTotal = document.getElementById('finalTotal');
        DOM.deliveryMethod = document.getElementById('deliveryMethod');
        DOM.deliveryAddress = document.getElementById('deliveryAddress');
        DOM.deliveryTime = document.getElementById('deliveryTime');
        DOM.recipientName = document.getElementById('recipientName');
        DOM.recipientPhone = document.getElementById('recipientPhone');
        DOM.recipientEmail = document.getElementById('recipientEmail');
        DOM.statusText = document.getElementById('statusText');
        DOM.progressFill = document.getElementById('progressFill');
        DOM.currentStatusStep = document.getElementById('currentStatusStep');
        DOM.trackingInfo = document.getElementById('trackingInfo');
        DOM.cdekTrackingNumber = document.getElementById('cdekTrackingNumber');
        DOM.discountRow = document.getElementById('discountRow');
        DOM.discountAmount = document.getElementById('discountAmount');

        console.log('üì¶ DOM —ç–ª–µ–º–µ–Ω—Ç—ã –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω—ã');
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞
    async function loadOrderData() {
        console.log('üìä –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞...');

        try {
            // –ü–æ–ª—É—á–∞–µ–º ID –∑–∞–∫–∞–∑–∞ –∏ –ø–ª–∞—Ç–µ–∂–∞ –∏–∑ URL –∏–ª–∏ localStorage
            const urlParams = new URLSearchParams(window.location.search);
            const paymentId = urlParams.get('payment_id') || localStorage.getItem('currentPaymentId');
            const orderId = urlParams.get('order_id') || localStorage.getItem('currentOrderId');

            console.log('üîç –ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–∞:', { paymentId, orderId });

            // –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –∑–∞–∫–∞–∑ –ø–æ —Ä–∞–∑–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
            if (window.OrderManager) {
                if (paymentId) {
                    currentOrder = window.OrderManager.getOrderByPaymentId(paymentId);
                }

                if (!currentOrder && orderId) {
                    currentOrder = window.OrderManager.getOrderById(orderId);
                }

                // –ï—Å–ª–∏ –∑–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω, –±–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–æ–∑–¥–∞–Ω–Ω—ã–π
                if (!currentOrder) {
                    const recentOrders = window.OrderManager.getOrdersByStatus('created');
                    if (recentOrders.length > 0) {
                        currentOrder = recentOrders[0];
                    }
                }
            }

            // Fallback –Ω–∞ –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage
            if (!currentOrder) {
                console.log('üì¶ –ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ OrderManager, –ø—Ä–æ–≤–µ—Ä—è–µ–º localStorage...');
                const pendingOrderData = localStorage.getItem('pendingOrderData');
                if (pendingOrderData) {
                    currentOrder = JSON.parse(pendingOrderData);
                    console.log('‚úÖ –ó–∞–∫–∞–∑ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–∑ localStorage');
                }
            }

            // –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –Ω–µ—Ç –∑–∞–∫–∞–∑–∞, —Å–æ–∑–¥–∞–µ–º –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
            if (!currentOrder) {
                console.log('üîÑ –°–æ–∑–¥–∞–µ–º –∑–∞–∫–∞–∑ –∏–∑ –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ä–∑–∏–Ω—ã...');
                currentOrder = createOrderFromCart();
            }

            if (currentOrder) {
                console.log('üìã –î–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', currentOrder);

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –Ω–∞ "–æ–ø–ª–∞—á–µ–Ω"
                if (window.OrderManager && currentOrder.status === 'created') {
                    window.OrderManager.updateOrderStatus(currentOrder.id, 'payment_success');
                    currentOrder.status = 'payment_success';
                }

                renderOrderData();
                updateOrderStatus();
            } else {
                throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞');
            }

        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–∞:', error);

            // –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ—Å—É—Ä—Å
            currentOrder = createOrderFromCart();
            if (currentOrder) {
                renderOrderData();
            } else {
                showError('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞');
            }
        }
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∏–∑ –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ä–∑–∏–Ω—ã (fallback)
    function createOrderFromCart() {
        try {
            const cartData = getCartData();
            const { cameraCount, memoryCount, cameraColor } = cartData;

            if (cameraCount === 0 && memoryCount === 0) {
                return null;
            }

            const items = [];
            let totalAmount = 0;

            if (cameraCount > 0) {
                const cost = CONFIG.CAMERA_PRICE * cameraCount;
                items.push({
                    name: `clip & go –∫–∞–º–µ—Ä–∞ (${cameraCount} —à—Ç.)`,
                    cost: cost,
                    quantity: cameraCount
                });
                totalAmount += cost;
            }

            if (memoryCount > 0) {
                const cost = CONFIG.MEMORY_PRICE * memoryCount;
                items.push({
                    name: `–ö–∞—Ä—Ç–∞ –ø–∞–º—è—Ç–∏ 8 –ì–ë (${memoryCount} —à—Ç.)`,
                    cost: cost,
                    quantity: memoryCount
                });
                totalAmount += cost;
            }

            const order = {
                id: `CG-${Date.now()}-${Math.floor(Math.random() * 1000)}`,
                status: 'payment_success',
                amount: totalAmount,
                items: items,
                createdAt: new Date().toISOString(),
                delivery: {
                    type: '–°–î–≠–ö',
                    cost: 0
                },
                recipient: {
                    name: '–ü–æ–∫—É–ø–∞—Ç–µ–ª—å',
                    phone: '‚Äî'
                }
            };

            console.log('üîß –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã:', order);
            return order;

        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã:', error);
            return null;
        }
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ä–∑–∏–Ω—ã
    function getCartData() {
        try {
            if (window.CartManager) {
                return window.CartManager.getCartData();
            } else {
                const data = JSON.parse(localStorage.getItem('cartData') || '{}');
                return {
                    cameraCount: data.cameraCount || 0,
                    memoryCount: data.memoryCount || 0,
                    cameraColor: data.cartColor || '–ß—ë—Ä–Ω—ã–π'
                };
            }
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è cartData:', error);
            return { cameraCount: 0, memoryCount: 0, cameraColor: '–ß—ë—Ä–Ω—ã–π' };
        }
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞
    function renderOrderData() {
        if (!currentOrder) return;

        console.log('üé® –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞...');

        // –ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞
        if (DOM.orderNumber) {
            DOM.orderNumber.textContent = currentOrder.cdekNumber || currentOrder.id;
        }

        // –¢–æ–≤–∞—Ä—ã
        renderOrderItems();

        // –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        renderFinancialSummary();

        // –î–æ—Å—Ç–∞–≤–∫–∞
        renderDeliveryInfo();

        // –ü–æ–ª—É—á–∞—Ç–µ–ª—å
        renderRecipientInfo();

        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        animateDataAppearance();
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
    function renderOrderItems() {
        if (!DOM.itemsList || !currentOrder.items) return;

        const itemsHTML = currentOrder.items.map(item => `
            <div class="item-card">
                <div class="item-image">
                    <img src="${getItemImage(item.name)}" alt="${item.name}" loading="lazy" />
                    <div class="item-quantity">${item.quantity || 1}</div>
                </div>
                <div class="item-details">
                    <h4>${item.name}</h4>
                    <p>${getItemDescription(item.name)}</p>
                    <div class="item-price">
                        <span class="unit-price">${formatPrice(item.cost / (item.quantity || 1))} √ó ${item.quantity || 1}</span>
                        <span class="total-price">${formatPrice(item.cost)}</span>
                    </div>
                </div>
            </div>
        `).join('');

        DOM.itemsList.innerHTML = itemsHTML;
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
    function getItemImage(itemName) {
        if (itemName.includes('–∫–∞–º–µ—Ä–∞')) {
            return '/assets/images/cam3.jpg';
        } else if (itemName.includes('–ø–∞–º—è—Ç–∏')) {
            return '/assets/images/CardPhoto.png';
        }
        return '/assets/images/default.jpg';
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
    function getItemDescription(itemName) {
        if (itemName.includes('–∫–∞–º–µ—Ä–∞')) {
            return '–ö–æ–º–ø–∞–∫—Ç–Ω–∞—è —ç–∫—à–Ω-–∫–∞–º–µ—Ä–∞';
        } else if (itemName.includes('–ø–∞–º—è—Ç–∏')) {
            return 'MicroSD –∫–ª–∞—Å—Å–∞ 10';
        }
        return '–¢–æ–≤–∞—Ä clip & go';
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Å–≤–æ–¥–∫–∏
    function renderFinancialSummary() {
        if (!currentOrder) return;

        const itemsTotal = currentOrder.items ?
            currentOrder.items.reduce((sum, item) => sum + (item.cost || 0), 0) : 0;

        const deliveryTotal = currentOrder.delivery?.cost || 0;
        const discountAmount = currentOrder.discount?.amount || 0;

        if (DOM.itemsTotal) DOM.itemsTotal.textContent = formatPrice(itemsTotal);
        if (DOM.deliveryTotal) DOM.deliveryTotal.textContent = formatPrice(deliveryTotal);
        if (DOM.finalTotal) DOM.finalTotal.textContent = formatPrice(currentOrder.amount || 0);

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∫–∏–¥–∫—É –µ—Å–ª–∏ –µ—Å—Ç—å
        if (discountAmount > 0 && DOM.discountRow && DOM.discountAmount) {
            DOM.discountAmount.textContent = formatPrice(discountAmount);
            DOM.discountRow.style.display = 'flex';
        }
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ—Å—Ç–∞–≤–∫–µ
    function renderDeliveryInfo() {
        if (!currentOrder?.delivery) return;

        const delivery = currentOrder.delivery;

        if (DOM.deliveryMethod) {
            DOM.deliveryMethod.textContent = `–î–æ—Å—Ç–∞–≤–∫–∞ ${delivery.type || '–°–î–≠–ö'}`;
        }

        if (DOM.deliveryAddress && delivery.address) {
            DOM.deliveryAddress.textContent = delivery.address;
        }

        if (DOM.deliveryTime) {
            const estimatedDays = getEstimatedDeliveryDays(delivery.tariff);
            DOM.deliveryTime.textContent = `–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏: ${estimatedDays}`;
        }
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ
    function renderRecipientInfo() {
        if (!currentOrder?.recipient) return;

        const recipient = currentOrder.recipient;

        if (DOM.recipientName && recipient.name) {
            DOM.recipientName.textContent = recipient.name;
        }

        if (DOM.recipientPhone && recipient.phone) {
            DOM.recipientPhone.textContent = recipient.phone;
        }

        if (DOM.recipientEmail && recipient.email) {
            DOM.recipientEmail.textContent = recipient.email;
            DOM.recipientEmail.style.display = 'inline';
        }
    }

    // –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞
    function startStatusMonitoring() {
        console.log('üîÑ –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞...');

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
        statusCheckInterval = setInterval(async () => {
            if (currentOrder && window.OrderManager) {
                const updatedOrder = window.OrderManager.getOrderById(currentOrder.id);
                if (updatedOrder && updatedOrder.status !== currentOrder.status) {
                    console.log('üì¶ –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –∏–∑–º–µ–Ω–∏–ª—Å—è:', currentOrder.status, '->', updatedOrder.status);
                    currentOrder = updatedOrder;
                    updateOrderStatus();
                }
            }
        }, CONFIG.STATUS_UPDATE_INTERVAL);

        // –°–∏–º—É–ª—è—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
        setTimeout(() => {
            simulateStatusUpdate('processing', '–ó–∞–∫–∞–∑ –ø–µ—Ä–µ–¥–∞–Ω –≤ –æ–±—Ä–∞–±–æ—Ç–∫—É');
        }, 5000);

        setTimeout(() => {
            simulateStatusUpdate('shipped', '–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∫—É—Ä—å–µ—Ä–æ–º');
        }, 15000);
    }

    // –°–∏–º—É–ª—è—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
    function simulateStatusUpdate(newStatus, message) {
        if (currentOrder && window.OrderManager) {
            const additionalData = {};

            if (newStatus === 'shipped') {
                additionalData.cdekNumber = `CG${Math.floor(Math.random() * 10000000)}`;
                additionalData.trackingNumber = additionalData.cdekNumber;
            }

            window.OrderManager.updateOrderStatus(currentOrder.id, newStatus, additionalData);
            currentOrder.status = newStatus;

            if (additionalData.cdekNumber) {
                currentOrder.cdekNumber = additionalData.cdekNumber;
            }

            updateOrderStatus();
            showNotification(message, 'success');
        }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
    function updateOrderStatus() {
        if (!currentOrder) return;

        const status = currentOrder.status;
        console.log('üìä –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞:', status);

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—É—Å–∞
        updateStatusText(status);

        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
        updateProgressBar(status);

        // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —à–∫–∞–ª—É
        updateTimeline(status);

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—Ä–µ–∫–∏–Ω–≥–µ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞
        if (currentOrder.cdekNumber && status === 'shipped') {
            showTrackingInfo();
        }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å—Ç–∞—Ç—É—Å–∞
    function updateStatusText(status) {
        if (!DOM.statusText) return;

        const statusMessages = {
            'created': '–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω, –æ–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏...',
            'payment_success': '–û–ø–ª–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∑–∞–∫–∞–∑...',
            'processing': '–ó–∞–∫–∞–∑ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ, –≥–æ—Ç–æ–≤–∏–º –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ...',
            'shipped': '–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –û–∂–∏–¥–∞–π—Ç–µ –¥–æ—Å—Ç–∞–≤–∫—É.',
            'delivered': '–ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω! –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É!',
            'failed': '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–∫–∞–∑–∞.'
        };

        DOM.statusText.textContent = statusMessages[status] || '–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–∞—à –∑–∞–∫–∞–∑...';
        DOM.statusText.style.animation = 'statusTextUpdate 0.5s ease-in-out';

        setTimeout(() => {
            DOM.statusText.style.animation = '';
        }, 500);
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
    function updateProgressBar(status) {
        if (!DOM.progressFill) return;

        const progressMap = {
            'created': 25,
            'payment_success': 35,
            'processing': 60,
            'shipped': 85,
            'delivered': 100,
            'failed': 0
        };

        const targetProgress = progressMap[status] || 25;

        // –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        animateProgress(targetProgress);
    }

    // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    function animateProgress(targetPercent) {
        const currentPercent = parseInt(DOM.progressFill.style.width) || 0;
        const duration = CONFIG.PROGRESS_ANIMATION_DURATION;
        const startTime = performance.now();

        function updateProgress(currentTime) {
            const elapsed = currentTime - startTime;
            const progress = Math.min(elapsed / duration, 1);

            const currentWidth = currentPercent + (targetPercent - currentPercent) * easeOutCubic(progress);
            DOM.progressFill.style.width = `${currentWidth}%`;

            if (progress < 1) {
                requestAnimationFrame(updateProgress);
            }
        }

        requestAnimationFrame(updateProgress);
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª—ã
    function updateTimeline(status) {
        const steps = document.querySelectorAll('.status-step');
        const statusOrder = ['payment_success', 'processing', 'shipped', 'delivered'];
        const currentIndex = statusOrder.indexOf(status);

        steps.forEach((step, index) => {
            step.classList.remove('active', 'completed');

            if (index < currentIndex) {
                step.classList.add('completed');
            } else if (index === currentIndex) {
                step.classList.add('active');
            }
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞
        if (DOM.currentStatusStep) {
            const stepTexts = {
                'payment_success': '–°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–∫–∞–∑',
                'processing': '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ',
                'shipped': '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω',
                'delivered': '–î–æ—Å—Ç–∞–≤–ª–µ–Ω'
            };

            const stepText = DOM.currentStatusStep.querySelector('span');
            if (stepText && stepTexts[status]) {
                stepText.textContent = stepTexts[status];
            }
        }
    }

    // –ü–æ–∫–∞–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç—Ä–µ–∫–∏–Ω–≥–µ
    function showTrackingInfo() {
        if (!DOM.trackingInfo || !currentOrder.cdekNumber) return;

        if (DOM.cdekTrackingNumber) {
            DOM.cdekTrackingNumber.textContent = currentOrder.cdekNumber;
        }

        const trackingLink = document.getElementById('cdekTrackingLink');
        if (trackingLink) {
            trackingLink.href = `https://www.cdek.ru/track.html?order_id=${currentOrder.cdekNumber}`;
            trackingLink.style.display = 'inline-block';
        }

        const copyBtn = document.getElementById('copyTrackingBtn');
        if (copyBtn) {
            copyBtn.style.display = 'inline-block';
            copyBtn.onclick = () => copyToClipboard(currentOrder.cdekNumber);
        }

        DOM.trackingInfo.style.display = 'block';
        DOM.trackingInfo.style.animation = 'slideInUp 0.5s ease-out';
    }

    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
    function copyToClipboard(text) {
        if (navigator.clipboard) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification('üìã –ù–æ–º–µ—Ä —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!', 'success');
            });
        } else {
            // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            showNotification('üìã –ù–æ–º–µ—Ä —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!', 'success');
        }
    }

    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
    function setupEventListeners() {
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        const modalClose = document.querySelector('.modal-close');
        if (modalClose) {
            modalClose.onclick = () => {
                document.getElementById('orderStatusModal').style.display = 'none';
            };
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –Ω–µ–≥–æ
        window.onclick = (event) => {
            const modal = document.getElementById('orderStatusModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        };

        console.log('üîó –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã');
    }

    // –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–π –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    function scheduleAnimationsAndNotifications() {
        // –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
        setTimeout(createConfetti, 1000);

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        setTimeout(() => {
            showNotification('üéâ –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É! –í–∞—à –∑–∞–∫–∞–∑ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è.', 'success', 8000);
        }, 3000);

        setTimeout(() => {
            showNotification('üì± –í—ã –º–æ–∂–µ—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ.', 'info', 6000);
        }, 6000);

        // –í–∏–±—Ä–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
        if ('vibrate' in navigator) {
            navigator.vibrate([100, 50, 100]);
        }

        // –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
        setTimeout(() => {
            if (window.CartManager) {
                window.CartManager.clearCart();
            } else {
                localStorage.removeItem('cartData');
            }
            console.log('üßπ –ö–æ—Ä–∑–∏–Ω–∞ –æ—á–∏—â–µ–Ω–∞');
        }, 5000);

        console.log('üìÖ –ê–Ω–∏–º–∞—Ü–∏–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã');
    }

    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    function animateDataAppearance() {
        const elements = [
            '.order-info-card',
            '.action-cards',
            '.info-section'
        ];

        elements.forEach((selector, index) => {
            const element = document.querySelector(selector);
            if (element) {
                element.style.opacity = '0';
                element.style.transform = 'translateY(30px)';

                setTimeout(() => {
                    element.style.transition = 'all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
                    element.style.opacity = '1';
                    element.style.transform = 'translateY(0)';
                }, 500 + (index * 200));
            }
        });
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
    function createConfetti() {
        console.log('üéä –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏...');

        const colors = ['#4CAF50', '#667eea', '#764ba2', '#FFD700', '#FF6B6B', '#4ECDC4'];
        const confettiContainer = document.createElement('div');
        confettiContainer.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        `;
        document.body.appendChild(confettiContainer);

        // –°–æ–∑–¥–∞–µ–º 50 –∫—É—Å–æ—á–∫–æ–≤ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
        for (let i = 0; i < 50; i++) {
            const confetti = document.createElement('div');
            const color = colors[Math.floor(Math.random() * colors.length)];
            const size = Math.random() * 8 + 4;
            const startX = Math.random() * window.innerWidth;
            const duration = Math.random() * 2000 + 2000;
            const delay = Math.random() * 1000;

            confetti.style.cssText = `
                position: absolute;
                top: -10px;
                left: ${startX}px;
                width: ${size}px;
                height: ${size}px;
                background: ${color};
                border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
                opacity: 0.8;
                animation: confetti-fall ${duration}ms ease-in ${delay}ms forwards;
            `;

            confettiContainer.appendChild(confetti);
        }

        // –û—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            if (confettiContainer.parentNode) {
                confettiContainer.parentNode.removeChild(confettiContainer);
            }
        }, 4000);
    }

    // –ü–æ–∫–∞–∑ –æ—à–∏–±–∫–∏
    function showError(message) {
        const errorDiv = document.createElement('div');
        errorDiv.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(239, 68, 68, 0.9);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            z-index: 10000;
            max-width: 400px;
        `;
        errorDiv.innerHTML = `
            <h3>‚ùå –û—à–∏–±–∫–∞</h3>
            <p>${message}</p>
            <button onclick="window.location.href='/index.html'" style="background: white; color: #ef4444; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin-top: 10px;">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
        `;
        document.body.appendChild(errorDiv);
    }

    // –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    function showNotification(message, type = 'info', duration = 4000) {
        let container = document.getElementById('notificationContainer');
        if (!container) {
            container = document.createElement('div');
            container.id = 'notificationContainer';
            container.style.cssText = `
                position: fixed;
                top: 24px;
                right: 24px;
                z-index: 10000;
                display: flex;
                flex-direction: column;
                gap: 16px;
                pointer-events: none;
            `;
            document.body.appendChild(container);
        }

        const notification = document.createElement('div');
        notification.className = `notification notification-${type}`;

        const colors = {
            success: '#10b981',
            info: '#1ca6f8',
            warning: '#f59e0b',
            error: '#ef4444'
        };

        const icons = {
            success: '‚úÖ',
            info: '‚ÑπÔ∏è',
            warning: '‚ö†Ô∏è',
            error: '‚ùå'
        };

        notification.style.cssText = `
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-left: 4px solid ${colors[type]};
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateX(400px);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            pointer-events: auto;
            max-width: 350px;
            animation: slideInRight 0.5s ease-out;
        `;

        notification.innerHTML = `
            <span style="font-size: 1.2em; color: ${colors[type]};">${icons[type]}</span>
            <span style="flex: 1; color: #1f2937; font-weight: 500;">${message}</span>
            <button style="background: none; border: none; font-size: 1.2em; color: #9ca3af; cursor: pointer;">&times;</button>
        `;

        container.appendChild(notification);

        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
        requestAnimationFrame(() => {
            notification.style.transform = 'translateX(0)';
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è
        const closeBtn = notification.querySelector('button');
        closeBtn.onclick = () => removeNotification(notification);

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
        setTimeout(() => removeNotification(notification), duration);
    }

    function removeNotification(notification) {
        notification.style.transform = 'translateX(400px)';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 400);
    }

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    function formatPrice(price) {
        return (price || 0).toLocaleString('ru-RU') + ' ‚ÇΩ';
    }

    function getEstimatedDeliveryDays(tariff) {
        const tariffMap = {
            137: '2-4 –¥–Ω—è',    // –°—Ç–∞–Ω–¥–∞—Ä—Ç –∫—É—Ä—å–µ—Ä
            482: '1-2 –¥–Ω—è',    // –≠–∫—Å–ø—Ä–µ—Å—Å –∫—É—Ä—å–µ—Ä
            136: '2-4 –¥–Ω—è',    // –°—Ç–∞–Ω–¥–∞—Ä—Ç –ü–í–ó
            483: '1-2 –¥–Ω—è',    // –≠–∫—Å–ø—Ä–µ—Å—Å –ü–í–ó
            368: '2-4 –¥–Ω—è',    // –°—Ç–∞–Ω–¥–∞—Ä—Ç –ø–æ—Å—Ç–∞–º–∞—Ç
            486: '1-2 –¥–Ω—è'     // –≠–∫—Å–ø—Ä–µ—Å—Å –ø–æ—Å—Ç–∞–º–∞—Ç
        };
        return tariffMap[tariff] || '2-5 –¥–Ω–µ–π';
    }

    function easeOutCubic(t) {
        return 1 - Math.pow(1 - t, 3);
    }

    // –î–æ–±–∞–≤–ª—è–µ–º CSS –∞–Ω–∏–º–∞—Ü–∏–∏
    const style = document.createElement('style');
    style.textContent = `
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideInUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes statusTextUpdate {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.02); }
            100% { opacity: 1; transform: scale(1); }
        }

        .progress-fill {
            transition: width 0.3s ease-out;
        }

        .status-step.active {
            animation: statusPulse 2s infinite;
        }

        @keyframes statusPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .recipient-info, .tracking-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .recipient-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .recipient-name {
            font-weight: 600;
            font-size: 1.1em;
        }

        .recipient-contacts {
            display: flex;
            gap: 16px;
            color: rgba(255, 255, 255, 0.8);
        }

        .tracking-details {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .tracking-number {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .copy-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s ease;
        }

        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .tracking-link {
            color: #1ca6f8;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s ease;
        }

        .tracking-link:hover {
            color: #0ea5e9;
        }
    `;
    document.head.appendChild(style);

    // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.addEventListener('beforeunload', () => {
        if (statusCheckInterval) {
            clearInterval(statusCheckInterval);
        }

        // –û—á–∏—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        localStorage.removeItem('pendingOrderData');
        localStorage.removeItem('currentPaymentId');
        localStorage.removeItem('currentOrderId');
    });

    console.log('üöÄ –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
</script>
</body>
</html>